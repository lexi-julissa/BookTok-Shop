/*! BARNES-BUILDER 2024-02-21 */
BN.Modal.Ropis=BN.Modal.Ropis||{},BN.Modal.Ropis.Base=BN.Modal.Ropis.Base||Extend(function(){var a=function(){consoleLog("Instantiating BN.Modal.Ropis.Base")};return a.prototype={defaultOptions:{tplDir:SITE_ROOT+"/modals/ropis/"},tplName:"reserve-for-store-modal",initView:function(){{var a=(this.data,$(this.modal));a.find("form")}this.on("display",function(){$("#allContributors").html($("#key-contributors").html()),"true"==$("#nookProtectionRequired").val()&&$("#nookProtectionRequiredBopis").val("true"),intiateRecaptchaVthree("#reserveModalForm"),BN.uXHR.Form.apply(a.find("form.pdp-form")),BN.uXHR.Form.apply(a.find("form#reserveModalForm")),$(".modal-reserve-for-store-pickup").parent().css("background","#254d3e"),setTimeout(function(){$(".modal-reserve-for-store-pickup .modal__header").get(0).scrollIntoView()},0)}),this.closeEvents.all.push(function(){$(".bopis-purchase-optn--formcont").html(""),pdpBopisSectionLoad()}),a.find("form.pdp-form").on("amplifiFormBeforeSubmit",function(){showSpinner(".paynow-btn .pdp-form")}).on("amplifiFormSuccess",function(b,c){var d=findAddToCartButton(this),e=d.get(0),f=a.find("form.pdp-form");RhfLoadHeaderElement($(".rhf-navbar-nav-cart > li > div.dropdown-menu"),webContextRoot+"/includes/minicart-shopping-bag.jsp",!0,!0),closeAllModals(),$("#addToCartSuccessModalOpenFrom").val("ropis"),addToCartModalCall(!1,e,c,f),"undefined"!=typeof s_setP&&updateAnalyticsCart()}).on("amplifiFormError",function(){hideSpinner(".paynow-btn .pdp-form")}),a.find("form#reserveModalForm").on("amplifiFormBeforeSubmit",function(){showSpinner("#reserveModalForm")}).on("amplifiFormSuccess",function(a,b){if("true"==b.ropisSuccess){closeAllModals();var c=$("#productSkuId").val(),d={useCache:!1,tplParams:{ean:c}};new BN.Modal.Ropis.ReserveThankYou(null,{target:this},d);var e="reserve-thank-you-modal";thankYouRopisAnalytics(e)}}).on("amplifiFormError",function(a,b){var c=$(a.currentTarget).attr("id"),d=$("#"+c),e=d.find("#reserveBtn");"true"==b.outOfStock?($("#displayReserveError").hide(),$("#Exceptionerror").hide(),$("#outOfStock em").html(b.response.items[0]),$("#outOfStock").show(),$(".outOfStock").removeClass("d-none"),onROPISStoreChangeFailed()):"true"==b.Exception?($("#displayReserveError").hide(),$("#outOfStock").hide(),$("#Exceptionerror em").html(b.response.items[0]),$("#Exceptionerror").show(),$(".modal-reserve-for-store-pickup .modal__header").get(0).scrollIntoView(),"true"==$("#displayReserveError").attr("aria-atomic")&&($("#displayReserveError").parent().parent().find(".top-text-mobile").addClass("d-none"),$("#displayReserveError").parent().parent().find(".top-text-desktop").addClass("d-none"),$("#displayReserveError").parents().find(".error-message").addClass("error-msg-flex"),$(".Exception").removeClass("d-none")),onROPISStoreChangeFailed()):($("#Exceptionerror").hide(),$("#outOfStock").hide(),$("#displayReserveError").parent().parent().find(".top-text-mobile").removeClass("d-none"),$("#displayReserveError").parent().parent().find(".top-text-desktop").removeClass("d-none"),$(".outOfStock .Exception").addClass("d-none")),"2FAREQUIRED"==b.response.items[0].toUpperCase()&&($("#displayReserveError").hide(),new BN.Modal.Account.TwoStepVerification(null,{target:this},{useCache:!1,tplParams:{formName:d,formBtn:e,formId:c,captchav3Enabled:"undefined"!=typeof captchaV3ApiKey}})),hideSpinner("#reserveModalForm")}),a.find("#pickupAvailableAlert").on("click",function(){$(this).is(":checked")?$("#phoneNoContainer").removeClass("d-none"):$("#phoneNoContainer").addClass("d-none")}),a.find(".open-ss-modal").on("click",function(){onRopisStoreChangeButtonClick()}),a.find("#reserveBtn").on("click",function(){$("#displayReserveError").hide();var a=$("#bopisEligibleMsg").val(),b=$("#firstName"),c=$("#lastName"),d=$("#email"),e=[],f=[];if(""==b.val()?(e.push("firstName"),f.push("First Name field cannot be left blank")):isValidString(b.val(),b.attr("pattern"))||(e.push("firstName"),f.push("First Name includes invalid characters, please update field to continue.")),""==c.val()?(e.push("lastName"),f.push("Last Name field cannot be left blank")):isValidString(c.val(),c.attr("pattern"))||(e.push("lastName"),f.push("Last Name includes invalid characters, please update field to continue.")),""==d.val()?(e.push("email"),f.push("Email field cannot be left blank")):isValidString(d.val(),d.attr("pattern"))||(e.push("email"),f.push("Email includes invalid characters, please update field to continue.")),$("#phoneNoContainer").is(":visible")){var g=$("#phone").val();""!=g&&(!phoneNumberValidation(g)||g.length<10)&&(e.push("phone"),f.push("Please enter valid phone number"))}if(("storeNotAvailable"==a||"productNotAvailable"==a)&&(e.push("store"),f.push("Store address cannot be left blank")),$(".reserve-form-field").parent().removeClass("invalid focus"),e.length>0){for(var h="",i=0;i<e.length;i++)h+='<em class="emphasis emphasis--alert">'+f[i]+"</em>",$("#"+e[i]).parent().addClass("invalid focus"),$("#"+e[0]).focus();return $("#displayReserveError").html(h),$("#displayReserveError").show(),!1}}),a.find(".payment-type").on("click",function(){"online"==$(this).val()?($(".paynow-container").removeClass("d-none"),$(".paylater-container").addClass("d-none")):($(".paylater-container").removeClass("d-none"),$(".paynow-container").addClass("d-none"))})}},a}(),BN.Modal.Base,!0),BN.Modal.Ropis.ReserveThankYou=BN.Modal.Ropis.ReserveThankYou||Extend(function(){var a=function(){consoleLog("Instantiating BN.Modal.Ropis.ReserveThankYou")};return a.prototype={tplName:"reserve-thank-you-modal",initView:function(){this.on("display",function(){$("#allContributors").html($("#key-contributors").html()),$(".modal-reserve-for-store-pickup").parent().css("background","#254d3e"),setTimeout(function(){$(".modal-reserve-for-store-pickup .modal__header").get(0).scrollIntoView()},0)})}},a}(),BN.Modal.Ropis.Base,!0);